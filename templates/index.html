<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MPCDC - Machine Learning Clustering Model</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>MPCDC - Machine Learning Clustering Model</h1>
        </div>
    </header>

    <main>
        <div class="container">
            {% if use_mock %}
            <div class="notification">
                <i class="fas fa-info-circle"></i> Running in demo mode. Set a valid Databricks token in the .env file to enable full functionality.
            </div>
            {% endif %}
            
            <div class="content-wrapper">
                <section class="main-content">
                    <h2>Project Description</h2>
                    <p>Welcome to the Machine Learning Clustering Model for Predictive Change and Incident Management.</p>
                    
                    <div class="project-description">
                        <h3>About the Project</h3>
                        <p>This project leverages advanced machine learning clustering techniques to analyze patterns in infrastructure changes and incidents, enabling a shift from reactive to preventive strategies for managing IT operations.</p>
                        
                        <h3>Key Features</h3>
                        <ul>
                            <li><strong>Cluster Analysis:</strong> Identifies patterns in changes and incidents based on type and time-to-complete/resolve.</li>
                            <li><strong>Predictive Insights:</strong> Predicts potential incidents that could arise from specific types of changes.</li>
                            <li><strong>Action Plans:</strong> Proposes actionable strategies with confidence levels to mitigate risks and optimize resource allocation.</li>
                        </ul>
                        
                        <h3>Datasets</h3>
                        <p>The model analyzes two primary datasets:</p>
                        <ul>
                            <li><strong>Changes Dataset:</strong> Contains information about infrastructure changes, including type, associated services, assigned providers, and time-to-complete.</li>
                            <li><strong>Incidents Dataset:</strong> Contains information about incidents, including type, criticality, and time-to-resolve.</li>
                        </ul>
                        
                        <h3>How It Works</h3>
                        <p>The clustering model identifies patterns in changes and incidents, such as common types that frequently lead to critical issues or delays. Based on these insights, it proposes actionable strategies to mitigate risks, prevent incidents, and optimize resource allocation.</p>
                        
                        <h3>Benefits</h3>
                        <ul>
                            <li>Shift from reactive to preventive incident management</li>
                            <li>Optimize resource allocation</li>
                            <li>Reduce downtime and service disruptions</li>
                            <li>Save time, money, and resources</li>
                        </ul>
                        
                        <h3>Clustering Model Visualization</h3>
                        <div class="cluster-images">
                            <div class="cluster-image-container">
                                <h4>Changes Clustering</h4>
                                <img src="{{ url_for('static', filename='images/cluster_changes.png') }}" alt="Changes Clustering Model" class="cluster-img">
                                <p>Visualization of the clustering model for infrastructure changes, showing patterns based on type and time-to-complete.</p>
                            </div>
                            <div class="cluster-image-container">
                                <h4>Incidents Clustering</h4>
                                <img src="{{ url_for('static', filename='images/cluster_incidents.png') }}" alt="Incidents Clustering Model" class="cluster-img">
                                <p>Visualization of the clustering model for incidents, showing patterns based on type and time-to-resolve.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="change-classification-section" id="changeClassificationSection">
                        <h3>Change Classification</h3>
                        <p>Submit detailed information about a change to analyze its potential impact and risk level.</p>
                        
                        <form id="changeClassificationForm" class="change-form">
                            <div class="form-group">
                                <label for="infrastructure_change_id">Change ID*</label>
                                <input type="text" id="infrastructure_change_id" name="infrastructure_change_id" required>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="submit_date">Submit Date</label>
                                    <input type="datetime-local" id="submit_date" name="submit_date">
                                </div>
                                
                                <div class="form-group">
                                    <label for="scheduled_start_date">Scheduled Start Date</label>
                                    <input type="datetime-local" id="scheduled_start_date" name="scheduled_start_date">
                                </div>
                                
                                <div class="form-group">
                                    <label for="scheduled_end_date">Scheduled End Date</label>
                                    <input type="datetime-local" id="scheduled_end_date" name="scheduled_end_date">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="f01_chr_serviceid">Service ID*</label>
                                    <input type="text" id="f01_chr_serviceid" name="f01_chr_serviceid" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="serviceci">Service CI*</label>
                                    <input type="text" id="serviceci" name="serviceci" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="ASORG">AS Organization</label>
                                    <input type="text" id="ASORG" name="ASORG">
                                </div>
                                
                                <div class="form-group">
                                    <label for="ASGRP">AS Group</label>
                                    <input type="text" id="ASGRP" name="ASGRP">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="categorization_tier_1">Categorization Tier 1</label>
                                    <select id="categorization_tier_1" name="categorization_tier_1">
                                        <option value="">Select...</option>
                                        <option value="INFRAESTRUCTURA">INFRAESTRUCTURA</option>
                                        <option value="DESPLEGAMENT MULTIAMBIT">DESPLEGAMENT MULTIAMBIT</option>
                                        <option value="DESPLEGAMENT">DESPLEGAMENT</option>
                                        <option value="SEGURETAT">SEGURETAT</option>
                                        <option value="INFRAESTRUCTURA MULTIAMBIT">INFRAESTRUCTURA MULTIAMBIT</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="categorization_tier_2">Categorization Tier 2</label>
                                    <input type="text" id="categorization_tier_2" name="categorization_tier_2">
                                </div>
                                
                                <div class="form-group">
                                    <label for="categorization_tier_3">Categorization Tier 3</label>
                                    <input type="text" id="categorization_tier_3" name="categorization_tier_3">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="product_cat_tier_1">Product Category Tier 1</label>
                                    <input type="text" id="product_cat_tier_1" name="product_cat_tier_1">
                                </div>
                                
                                <div class="form-group">
                                    <label for="product_cat_tier_2">Product Category Tier 2</label>
                                    <input type="text" id="product_cat_tier_2" name="product_cat_tier_2">
                                </div>
                                
                                <div class="form-group">
                                    <label for="product_cat_tier_3">Product Category Tier 3</label>
                                    <input type="text" id="product_cat_tier_3" name="product_cat_tier_3">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="change_request_status">Change Request Status</label>
                                    <input type="number" id="change_request_status" name="change_request_status" min="0" value="0">
                                </div>
                                
                                <div class="form-group">
                                    <label for="Num_Incidencies">Related Incident ID</label>
                                    <input type="text" id="Num_Incidencies" name="Num_Incidencies" placeholder="e.g., INC000009582237">
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" id="submitChangeBtn" class="btn-primary">
                                    <i class="fas fa-analytics"></i> Analyze Change
                                </button>
                            </div>
                        </form>
                        
                        <div id="classificationResults" class="classification-results hidden">
                            <h4>Classification Results</h4>
                            <div id="resultsContent" class="results-content">
                                <!-- Results will be displayed here -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <aside class="sidebar">
                    <div class="chatbot-container">
                        <div class="chatbot-header">
                            <h3><i class="fas fa-robot"></i> ML Insights Assistant</h3>
                        </div>
                        <div class="chatbot-messages" id="chatMessages">
                            <div class="message bot">
                                <div class="message-content">
                                    Hello! I'm your ML Insights Assistant. Please provide information about the change you'd like to analyze. You can also use the form below to submit detailed change information for classification.
                                    {% if use_mock %}
                                    <br><br><small><i>Note: I'm currently running in demo mode with predefined responses.</i></small>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="chatbot-input">
                            <input type="text" id="userInput" placeholder="Type your message here...">
                            <button id="sendButton"><i class="fas fa-paper-plane"></i></button>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 MPCDC - Machine Learning Clustering Model</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>
    <script src="{{ url_for('static', filename='js/change-classification.js') }}"></script>
</body>
</html>
